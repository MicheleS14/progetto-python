import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

def played_Match_Maps(df : pd.DataFrame) -> pd.DataFrame:
    """Ritorna un dataframe con il numero di partite giocate per ogni mappa"""
    df_most_play = df.groupby("mapname")["matchid"].nunique()
    return df_most_play

def operator_Played (df : pd.DataFrame, map : str) -> pd.DataFrame:
    """Ritorna il numero di round totali in cui l'operatore e' stato giocato in una determinata mappa\nSe si verifica un errore ritorna False"""
    try:
        df_operator = df[df["mapname"] == map].groupby("operator")["operator"].count()
    except:
        return False
    return df_operator

def show_Map_Played_Chart(df_Map_PC_Mode : pd.DataFrame, df_Map_PS4_Mode : pd.DataFrame, df_Map_XBOX_Mode : pd.DataFrame, gamemode : str) -> None:
    x = np.arange(16)
    heigth = 0.2

    plt.figure(figsize=(20,20))
    plt.barh(x - heigth, df_Map_PC_Mode, height=heigth, color="darkblue")
    plt.barh(x, df_Map_PS4_Mode, height=heigth, color="green")
    plt.barh(x + heigth, df_Map_XBOX_Mode, height=heigth, color="cyan")
    plt.yticks(x, df_Map_PC_Mode.index)
    plt.title(f"Numero partite per mappa in {gamemode}")
    plt.legend(["PC", "PS4", "XBOX"])
    plt.show()


def win_Rate (df : pd.DataFrame) -> pd.DataFrame:

    partite_vinte = df[df['haswon'] == True]
    df_Win_Perc = (partite_vinte.groupby('operator').size() / df.groupby('operator').size() * 100) - 50
    return df_Win_Perc

def pick_Rate (df : pd.DataFrame) -> pd.DataFrame:
    pass
